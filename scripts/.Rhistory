coef(mod4.1)
column_names_samples <- colnames(samples1)
columns_to_get <- column_names_samples[str_detect(column_names_samples, "r_class__dispersalkm\\[[A-Z, a-z]*,logM")]
apply(samples1[, columns_to_get], 2, FUN = function(x) c(mean(x), quantile(x, c(0.025, 0.5,0.975))))
coef(mod4.1, summary = TRUE)
coef_no_summary <- coef(mod4.1, summary = FALSE)
coef_no_summary$class %>% dimnames()
# 1 = iteration, #2 class #3 slopes
coef_no_summary$class[,,] %>% dim()
apply(coef_no_summary$class[,,], c(2,3), FUN = function(x) c(mean(x), quantile(x, c(0.025, 0.5,0.975))))
coef_no_summary$class[,,2] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram() +
geom_vline(xintercept = 0, colour = 'red')
coef_no_summary$class[,,2] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram() +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowpot()
coef_no_summary$class[,,2] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram() +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()
?stat_bin
coef_no_summary$class[,,2] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()
coef_no_summary$class %>% dimnames()
coef_no_summary$class[,,2] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
ylab("Posterior mean slope")
coef_no_summary$class[,,2] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
xlab("Posterior mean slope")
class_dispersal_slope <- coef_no_summary$class[,,2] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
xlab("Posterior mean slope")
column_names_samples
columns_to_get <- column_names_samples[str_detect(column_names_samples, "r_class__hrradius\\[[A-Z, a-z]*,logM")]
apply(samples1[, columns_to_get], 2, FUN = function(x) c(mean(x), quantile(x, c(0.025, 0.5,0.975))))
coef_no_summary <- coef(mod4.1, summary = FALSE)
coef_no_summary$class %>% dimnames()
# 1 = iteration, #2 class #3 slopes
coef_no_summary$class[,,] %>% dim()
apply(coef_no_summary$class[,,], c(2,3), FUN = function(x) c(mean(x), quantile(x, c(0.025, 0.5,0.975))))
class_dispersal_slope <- coef_no_summary$class[,,2] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
xlab("Posterior mean slope")
class_foraging_slope <- coef_no_summary$class[,,2] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
xlab("Posterior mean slope")
class_foraging_slope
# dispersal
columns_to_get <- column_names_samples[str_detect(column_names_samples, "r_class__dispersalkm\\[[A-Z, a-z]*,logM")]
apply(samples1[, columns_to_get], 2, FUN = function(x) c(mean(x), quantile(x, c(0.025, 0.5,0.975))))
coef_no_summary <- coef(mod4.1, summary = FALSE)
coef_no_summary$class %>% dimnames()
# 1 = iteration, #2 class #3 slopes
coef_no_summary$class[,,] %>% dim()
apply(coef_no_summary$class[,,], c(2,3), FUN = function(x) c(mean(x), quantile(x, c(0.025, 0.5,0.975))))
class_dispersal_slope <- coef_no_summary$class[,,2] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
xlab("Posterior mean slope")
class_dispersal_slope
columns_to_get <- column_names_samples[str_detect(column_names_samples, "r_class__hrradius\\[[A-Z, a-z]*,logM")]
apply(samples1[, columns_to_get], 2, FUN = function(x) c(mean(x), quantile(x, c(0.025, 0.5,0.975))))
coef_no_summary <- coef(mod4.1, summary = FALSE)
coef_no_summary$class %>% dimnames()
# 1 = iteration, #2 class #3 slopes
coef_no_summary$class[,,] %>% dim()
apply(coef_no_summary$class[,,], c(2,3), FUN = function(x) c(mean(x), quantile(x, c(0.025, 0.5,0.975))))
class_foraging_slope <- coef_no_summary$class[,,2] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
xlab("Posterior mean slope")
class_foraging_slope
# 1 = iteration, #2 class #3 slopes
coef_no_summary$class[,,] %>% dim()
coef_no_summary$class %>% dimnames()
# 1 = iteration, #2 class #3 slopes
coef_no_summary$class[,,] %>% dim()
apply(coef_no_summary$class[,,], c(2,3), FUN = function(x) c(mean(x), quantile(x, c(0.025, 0.5,0.975))))
class_foraging_slope <- coef_no_summary$class[,,4] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
xlab("Posterior mean slope")
class_foraging_slope
coef_no_summary$class
coef_no_summary$class[,,4
]
apply(coef_no_summary$class[,,], c(2,3), FUN = function(x) c(mean(x), quantile(x, c(0.025, 0.5,0.975))))
coef_no_summary$class[,,4] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples")
coef_no_summary$class %>% dimnames()
# 1 = iteration, #2 class #3 slopes
coef_no_summary$class[,,] %>% dim()
columns_to_get
apply(samples1[, columns_to_get], 2, FUN = function(x) c(mean(x), quantile(x, c(0.025, 0.5,0.975))))
# 1 = iteration, #2 class #3 slopes
coef_no_summary$class[,,] %>% dim()
apply(coef_no_summary$class[,,], c(2,3), FUN = function(x) c(mean(x), quantile(x, c(0.025, 0.5,0.975))))
coef_no_summary$class[,,4]
coef_no_summary$class[,,4] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples")
apply(coef_no_summary$class[,,], c(2,3), FUN = function(x) c(mean(x), quantile(x, c(0.025, 0.5,0.975))))
# migration
class_migration_slope <- coef_no_summary$class[,,6] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
xlab("Posterior mean slope")
class_migration_slope
?ggarrange
ggarrange(class_foraging_slope, class_dispersal_slope, class_migration_slope, labels = c("Foraging", "Dispersal", "Migration"),
nrow = 1)
class_post_mean_slopes <- ggarrange(class_foraging_slope, class_dispersal_slope, class_migration_slope,
labels = c("Foraging", "Dispersal", "Migration"),
nrow = 1)
jpeg(filename = "../figures/class_posterior_means_slopes.jpeg", width = 9, height = 12, units = 'in', res = 1000)
class_post_mean_slopes
dev.off()
jpeg(filename = "../figures/class_posterior_means_slopes.jpeg", width = 9, height = 10, units = 'in', res = 1000)
class_post_mean_slopes
dev.off()
# migration
class_migration_slope <- coef_no_summary$class[,,6] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1, strip.position = "left") +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
xlab("Posterior mean slope")
class_post_mean_slopes <- ggarrange(class_foraging_slope, class_dispersal_slope, class_migration_slope,
labels = c("Foraging", "Dispersal", "Migration"),
nrow = 1)
class_foraging_slope <- coef_no_summary$class[,,4] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1, strip.position = "left") +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
xlab("Posterior mean slope")
# dispersal
class_dispersal_slope <- coef_no_summary$class[,,2] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1, strip.position = "left") +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
xlab("Posterior mean slope")
# migration
class_migration_slope <- coef_no_summary$class[,,6] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1, strip.position = "left") +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
xlab("Posterior mean slope")
class_post_mean_slopes <- ggarrange(class_foraging_slope, class_dispersal_slope, class_migration_slope,
labels = c("Foraging", "Dispersal", "Migration"),
nrow = 1)
jpeg(filename = "../figures/class_posterior_means_slopes.jpeg", width = 9, height = 10, units = 'in', res = 1000)
class_post_mean_slopes
dev.off()
coef_no_summary$class[,,6] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1, strip.background = element_rect(fill = "white")) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
xlab("Posterior mean slope")
coef_no_summary$class[,,6] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
theme(strip.background = element_rect(fill = "white"))
xlab("Posterior mean slope")
class_foraging_slope <- coef_no_summary$class[,,4] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
theme(strip.background = element_rect(fill = "white"))
xlab("Posterior mean slope")
# dispersal
class_dispersal_slope <- coef_no_summary$class[,,2] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
theme(strip.background = element_rect(fill = "white"))
xlab("Posterior mean slope")
# migration
class_migration_slope <- coef_no_summary$class[,,6] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
theme(strip.background = element_rect(fill = "white"))
class_foraging_slope <- coef_no_summary$class[,,4] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
theme(strip.background = element_rect(fill = "white"))+
xlab("Posterior mean slope")
# dispersal
class_dispersal_slope <- coef_no_summary$class[,,2] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
theme(strip.background = element_rect(fill = "white"))+
xlab("Posterior mean slope")
# migration
class_migration_slope <- coef_no_summary$class[,,6] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
theme(strip.background = element_rect(fill = "white"))+
xlab("Posterior mean slope")
class_post_mean_slopes <- ggarrange(class_foraging_slope, class_dispersal_slope, class_migration_slope,
labels = c("Foraging", "Dispersal", "Migration"),
nrow = 1)
jpeg(filename = "../figures/class_posterior_means_slopes.jpeg", width = 9, height = 10, units = 'in', res = 1000)
class_post_mean_slopes
dev.off()
jpeg(filename = "../figures/class_posterior_means_slopes.jpeg", width = 9, height = 9, units = 'in', res = 1000)
class_post_mean_slopes
dev.off()
jpeg(filename = "../figures/class_posterior_means_slopes.jpeg", width = 9, height = 7, units = 'in', res = 1000)
class_post_mean_slopes
dev.off()
#### creating figs for posterior mean slopes for each condition #######
#### Media ####
# foraging
foraging_media <- readRDS("../mods/mod3/foraging_media.rds")
coef_no_summary <- coef(foraging_media, summary = FALSE)
coef_no_summary$class %>% dimnames()
head(coef_no_summary)
coef(foraging_media, summary = FALSE)
foraging_media
coef_no_summary <- coef(media_foraging, summary = FALSE)
coef_no_summary$media_foraging %>% dimnames()
# 1 = iteration, #2 class #3 slopes
coef_no_summary$class[,,] %>% dim()
apply(coef_no_summary$class[,,], c(2,3), FUN = function(x) c(mean(x), quantile(x, c(0.025, 0.5,0.975))))
# 1 = iteration, #2 class #3 slopes
coef_no_summary$media_foraging[,,] %>% dim()
apply(coef_no_summary$media_foraging[,,], c(2,3), FUN = function(x) c(mean(x), quantile(x, c(0.025, 0.5,0.975))))
media_foraging_slope <- coef_no_summary$class[,,2] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
theme(strip.background = element_rect(fill = "white"))+
xlab("Posterior mean slope")
media_foraging_slope <- coef_no_summary$media_foraging[,,2] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
theme(strip.background = element_rect(fill = "white"))+
xlab("Posterior mean slope")
media_foraging_slope
# dispersal
# foraging
dispersal_media <- readRDS("../mods/mod3/dispersal_media.rds")
coef_no_summary <- coef(dispersal_media, summary = FALSE)
coef_no_summary$media_dispersal %>% dimnames()
# 1 = iteration, #2 class #3 slopes
coef_no_summary$media_dispersal[,,] %>% dim()
apply(coef_no_summary$media_dispersal[,,], c(2,3), FUN = function(x) c(mean(x), quantile(x, c(0.025, 0.5,0.975))))
media_dispersal_slope <- coef_no_summary$media_dispersal[,,2] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
theme(strip.background = element_rect(fill = "white"))+
xlab("Posterior mean slope")
media_dispersal_slope
# migration
migration_media <- readRDS("../mods/mod3/migration_media.rds")
coef_no_summary <- coef(migration_media, summary = FALSE)
coef_no_summary$media_migration %>% dimnames()
# 1 = iteration, #2 class #3 slopes
coef_no_summary$media_migration[,,] %>% dim()
apply(coef_no_summary$media_migration[,,], c(2,3), FUN = function(x) c(mean(x), quantile(x, c(0.025, 0.5,0.975))))
media_migration_slope <- coef_no_summary$media_migration[,,2] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
theme(strip.background = element_rect(fill = "white"))+
xlab("Posterior mean slope")
media_migration_slope
media_post_mean_slopes <- ggarrange(media_foraging_slope, media_dispersal_slope, media_migration_slope,
labels = c("Foraging", "Dispersal", "Migration"),
nrow = 1)
jpeg(filename = "../figures/class_posterior_means_slopes.jpeg", width = 7, height = 6, units = 'in', res = 1000)
media_post_mean_slopes
dev.off()
jpeg(filename = "../figures/media_posterior_means_slopes.jpeg", width = 7, height = 6, units = 'in', res = 1000)
media_post_mean_slopes
dev.off()
jpeg(filename = "../figures/media_posterior_means_slopes.jpeg", width = 9, height = 6, units = 'in', res = 1000)
media_post_mean_slopes
dev.off()
#### Class ####
# foraging
coef_no_summary <- coef(mod4.1, summary = FALSE)
coef_no_summary$class %>% dimnames()
# 1 = iteration, #2 class #3 slopes
coef_no_summary$class[,,] %>% dim()
apply(coef_no_summary$class[,,], c(2,3), FUN = function(x) c(mean(x), quantile(x, c(0.025, 0.5,0.975))))
class_foraging_slope <- coef_no_summary$class[,,4] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
theme(strip.background = element_rect(fill = "white"))+
xlab("Posterior mean slope")
# dispersal
class_dispersal_slope <- coef_no_summary$class[,,2] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
theme(strip.background = element_rect(fill = "white"))+
xlab("Posterior mean slope")
# migration
class_migration_slope <- coef_no_summary$class[,,6] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
theme(strip.background = element_rect(fill = "white"))+
xlab("Posterior mean slope")
class_post_mean_slopes <- ggarrange(class_foraging_slope, class_dispersal_slope, class_migration_slope,
labels = c("Foraging", "Dispersal", "Migration"),
nrow = 1)
jpeg(filename = "../figures/class_posterior_means_slopes.jpeg", width = 9, height = 7, units = 'in', res = 1000)
class_post_mean_slopes
dev.off()
#### Trophic Guild ####
mod5.2 <- readRDS("../mods/mod5_2.rds")
# foraging
coef_no_summary <- coef(mod5.2, summary = FALSE)
coef_no_summary$diet_broadest_cat %>% dimnames()
# 1 = iteration, #2 class #3 slopes
coef_no_summary$diet_broadest_cat[,,] %>% dim()
apply(coef_no_summary$diet_broadest_cat[,,], c(2,3), FUN = function(x) c(mean(x), quantile(x, c(0.025, 0.5,0.975))))
diet_foraging_slope <- coef_no_summary$diet_broadest_cat[,,4] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
theme(strip.background = element_rect(fill = "white"))+
xlab("Posterior mean slope")
# dispersal
diet_dispersal_slope <- coef_no_summary$diet_broadest_cat[,,2] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
theme(strip.background = element_rect(fill = "white"))+
xlab("Posterior mean slope")
# migration
diet_migration_slope <- coef_no_summary$diet_broadest_cat[,,6] %>%
as.data.frame() %>%
pivot_longer(everything(),names_to = "slope", values_to = "posterior_samples") %>%
ggplot(aes(x = posterior_samples)) +
facet_wrap(~slope, ncol = 1) +
geom_histogram(stat = "bin", bins = 100) +
geom_vline(xintercept = 0, colour = 'red') +
theme_cowplot()+
theme(strip.background = element_rect(fill = "white"))+
xlab("Posterior mean slope")
diet_post_mean_slopes <- ggarrange(diet_foraging_slope, diet_dispersal_slope, diet_migration_slope,
labels = c("Foraging", "Dispersal", "Migration"),
nrow = 1)
jpeg(filename = "../figures/diet_posterior_means_slopes.jpeg", width = 9, height = 7, units = 'in', res = 1000)
diet_post_mean_slopes
dev.off()
coef(mod5.2)
